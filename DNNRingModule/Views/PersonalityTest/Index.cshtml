@inherits DotNetNuke.Web.Mvc.Framework.DnnWebViewPage
@using DotNetNuke.Web.Client.ClientResourceManagement
@using DotNetNuke.Framework.JavaScriptLibraries
@using DotNetNuke.Entities.Users
@using System.Text.RegularExpressions
@using DotNetNuke.Web.Mvc.Helpers

@{
    var user = ViewBag.User as UserInfo;
    bool isLoggedIn = ViewBag.IsLoggedIn;
}

@if (isLoggedIn)
{
    <p>Hello, @user.DisplayName!</p>
}
else
{
    <p>⚠️Fontos: A tesztet csak regisztrált és bejelentkezett felhasználóink tölthetik ki, hogy személyre szabott ajánlást és kuponkódot tudjunk biztosítani számodra. Lépj be a fiókodba, vagy regisztrálj most, és indulhat a kaland!</p>
}

<h2>💍 Fedezd fel a hozzád illő gyűrűt!</h2>
<p>Személyiségtesztünkkel segítünk megtalálni a stílusodhoz és életmódodhoz legjobban illő gyűrűt. Válaszolj néhány egyszerű kérdésre, és mi megmutatjuk, mely darabok tükrözik legjobban az egyéniséged!</p>

@if (isLoggedIn)
{
    <a href="@Url.Action("TestStart", "PersonalityTest", new { ctl = "TestStart" })" class="btn btn-primary btn-lg">Kezdjünk!</a>
}
else
{
    <button id="customLoginTrigger" class="btn btn-primary btn-lg">Bejelentkezek</button>
}

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const loginBtn = document.getElementById("customLoginTrigger");
        if (loginBtn) {
            loginBtn.addEventListener("click", function (e) {
                e.preventDefault();
                const headerLogin = document.querySelector('.LoginLink');
                if (headerLogin) {
                    headerLogin.click();
                } else {
                    alert("Kérlek használd a fenti 'Bejelentkezés' menüpontot.");
                }
            });
        }
    });
</script>